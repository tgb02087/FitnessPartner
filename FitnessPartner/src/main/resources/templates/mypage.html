<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fitness Partner</title>
    <link th:href="@{/css/nav.css}" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
</head>
<body>
<header th:include="top.html"></header>
<div style="display: flex">
    <nav th:include="nav.html"></nav>
    <div style="margin: 10px">
        <input type="hidden" id="bodyId" th:value="${body.id}">
        <table class="table table-striped" style="text-align: center; border: 1px solid #dddddd">
            <thead>
            <tr>
                <th style="background-color: white; text-align: center;">마이페이지</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td><input type="text" class="form-control" placeholder="키" id="height" maxlength="50" th:value="${body.height}"></td>
            </tr>
            <tr>
                <td>운동량 :
                    <input type="radio" name="activity" value="25" checked>안함
                    <input type="radio" name="activity" value="30">주 1~2
                    <input type="radio" name="activity" value="35">주 3~5
                    <input type="radio" name="activity" value="40">매일
                </td>
            </tr>
            <tr>
                <td>표준 체중 : <span th:text="${body.weight}">weight</span></td>
            </tr>
            <tr>
                <td>권장칼로리 : <span th:text="${body.kcal}">kcal</span> Kcal</td>
            </tr>
            </tbody>
        </table>
        <button class="btn btn-secondary" onclick="mypage()">수정</button>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
<script th:inline="javascript">
    const activitys = document.getElementsByName('activity');
    const check = [[${body.activity}]];
    if(check==25) {
        activitys[0].checked = true;
    }
    else if(check==30) {
        activitys[1].checked = true;
    }
    else if(check==35) {
        activitys[2].checked = true;
    }
    else if(check==40) {
        activitys[3].checked = true;
    }
    const mypage = () => {
        const id = document.getElementById('bodyId').value;
        const height = document.getElementById('height').value;
        const activitys = document.getElementsByName('activity');
        let activity;
        activitys.forEach((radio)=>{
            if(radio.checked) {
                activity = radio.defaultValue;
            }
        })
        console.log(height);
        console.log(activity);
        $.ajax({
            type:"POST",
            url:"/bodyInfo/update",
            data: {
                id: id,
                height: height,
                activity: activity
            },
            dataType: "json",
            error: function() {
                location.reload(true);
            }
        });//ajax
    }
</script>
</body>
</html>